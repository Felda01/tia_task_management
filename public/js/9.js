(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{31:function(t,e,s){"use strict";s.r(e);var a=s(2);function i(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var o={name:"ProjectDetail",computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?i(Object(s),!0).forEach((function(e){r(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({sortedVersions:function(){if(this.project&&this.project.versions)return _.orderBy(this.project.versions,"end_date","asc")},filteredTasks:function(){var t=this;if(this.project.tasks&&this.project.tasks.length>0)switch(this.taskSort){case"normal-desc":return _.orderBy(this.project.tasks,["id"],["desc"]);case"end-date-asc":return _.orderBy(this.project.tasks,["end_date"],["asc"]);case"end-date-desc":return _.orderBy(this.project.tasks,["end_date"],["desc"]);case"priority-asc":return _.sortBy(this.project.tasks,(function(e){return t.prioritySort(e.priority,!1)}));case"priority-desc":return _.sortBy(this.project.tasks,(function(e){return t.prioritySort(e.priority,!0)}));default:return this.project.tasks}return[]}},Object(a.b)(["isSenior"])),data:function(){return{project:null,loading:!1,errorCode:0,projectStatusOptions:[],taskStatusOptions:[],taskPriorityOptions:[],allUsers:[],modalSchemaEditProject:{form:{url:"/api/projects/"+this.$route.params.slug,method:"put",fields:[],hiddenFields:[],config:{}},modalRef:"editProject",modalTitle:this.$t("project.edit.title.modal"),okBtnTitle:this.$t("modal.edit.btn")},modalSchemaAddTask:{form:{url:"/api/tasks",method:"post",fields:[{label:this.$t("task.title"),required:!0,name:"title",input:"text",type:"text",value:"",config:{}},{label:this.$t("task.description"),required:!0,name:"description",input:"textarea",type:"textarea",value:"",config:{}}],hiddenFields:[],config:{}},modalRef:"addTask",modalTitle:this.$t("project.task.add.title.modal"),okBtnTitle:this.$t("modal.add.btn")},modalSchemaAddUserToProject:{form:{url:"/api/projects/"+this.$route.params.slug+"/assign-user",method:"put",fields:[],hiddenFields:[],config:{}},modalRef:"addUserToProject",modalTitle:this.$t("project.add.user.title.modal"),okBtnTitle:this.$t("modal.assign.btn")},taskSort:"normal-asc",taskSortOptions:[{value:"normal-asc",text:this.$t("task.filter.normal.asc")},{value:"normal-desc",text:this.$t("task.filter.normal.desc")},{value:"end-date-asc",text:this.$t("task.filter.endDate.asc")},{value:"end-date-desc",text:this.$t("task.filter.endDate.desc")},{value:"priority-asc",text:this.$t("task.filter.priority.asc")},{value:"priority-desc",text:this.$t("task.filter.priority.desc")}]}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;this.loading=!0,this.axios.get("/api/projects/"+this.$route.params.slug).then((function(e){t.project=e.data.data,t.projectStatusOptions=e.data.meta.projectStatusOptions,t.taskStatusOptions=e.data.meta.taskStatusOptions,t.taskPriorityOptions=e.data.meta.taskPriorityOptions,t.allUsers=e.data.meta.allUsers.data,t.loading=!1})).catch((function(e){t.errorCode=e.response.status,t.loading=!1}))},editProjectModal:function(){this.modalSchemaEditProject.form.fields=[{label:this.$t("project.title"),required:!0,name:"title",input:"text",type:"text",value:this.project.title,config:{}},{label:this.$t("project.status"),required:!0,name:"status",input:"select",type:"text",value:this.project.status,config:{options:this.projectStatusOptions}},{label:this.$t("project.start_date"),required:!0,name:"start_date",input:"date",type:"date",value:this.project.start_date,config:{max:this.project.min_start_date}},{label:this.$t("project.end_date"),required:!1,name:"end_date",input:"date",type:"date",value:this.project.end_date,config:{min:this.project.max_end_date}}],this.$refs.editProjectModal.openModal()},editProject:function(t){this.project=t.data.data},addTaskModal:function(){var t,e=[{text:this.$t("task.version.no_version"),value:null}];if(this.sortedVersions&&this.sortedVersions.length>0)for(var s=0;s<this.sortedVersions.length;s++)e.push({text:this.sortedVersions[s].title,value:this.sortedVersions[s].id});var a=[{label:this.$t("task.start_date"),required:!0,name:"start_date",input:"date",type:"date",value:"",config:{min:this.project.start_date,max:this.project.end_date?this.project.end_date:null}},{label:this.$t("task.end_date"),required:!0,name:"end_date",input:"date",type:"date",value:"",config:{min:this.project.start_date,max:this.project.end_date?this.project.end_date:null}},{label:this.$t("task.priority"),required:!0,name:"priority",input:"select",type:"select",value:"",config:{options:this.taskPriorityOptions,disabledOption:!0}},{label:this.$t("task.version"),required:!1,name:"version_id",input:"select",type:"select",value:null,config:{options:e,disabledOption:!1}}];(t=this.modalSchemaAddTask.form.fields).push.apply(t,a),this.modalSchemaAddTask.form.hiddenFields=[{name:"project_id",value:this.project.id}],this.$refs.addTaskModal.openModal()},addTask:function(t){var e=t.data.data;this.$router.push({name:"tasks.show",params:{id:e.id}})},availableUsersForProject:function(){for(var t=[],e=_.differenceWith(this.allUsers,this.project.users,_.isEqual),s=0;s<e.length;s++)t.push({text:e[s].fullName,value:e[s].id});return t},addUserToProjectModal:function(){this.modalSchemaAddUserToProject.form.fields=[{label:this.$t("project.user"),required:!1,name:"user_id",input:"select",type:"select",value:null,config:{options:this.availableUsersForProject(),disabledOption:!0}}],this.$refs.addUserToProjectModal.openModal()},addUserToProject:function(t){this.project.users=t.data.data},prioritySort:function(t,e){switch(t){case"none":return e?5:1;case"low":return e?4:2;case"normal":return 3;case"high":return e?2:4;case"immediate":return e?1:5}}}},l=s(1),c=Object(l.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-detail"},[s("div",{staticClass:"row"},[t.loading?[s("div",{staticClass:"col-12"},[s("content-placeholders",{staticClass:"mb-4"},[s("content-placeholders-heading")],1)],1),t._v(" "),s("div",{staticClass:"col-lg-4 col-12"},[s("content-placeholders",{staticClass:"mb-4"},[s("content-placeholders-heading"),t._v(" "),s("content-placeholders-text",{attrs:{lines:3}})],1),t._v(" "),s("content-placeholders",{staticClass:"mb-4"},[s("content-placeholders-heading"),t._v(" "),s("content-placeholders-text",{attrs:{lines:3}})],1)],1),t._v(" "),s("div",{staticClass:"col-lg-8 col-12"},t._l(3,(function(e){return s("content-placeholders",{key:e,staticClass:"mb-4"},[s("content-placeholders-heading"),t._v(" "),s("content-placeholders-text",{attrs:{lines:3}})],1)})),1)]:t.project?[s("div",{staticClass:"col-12 mb-4 d-flex flex-lg-row flex-column justify-content-lg-between align-items-lg-center"},[s("h1",{staticClass:"mb-lg-0 mb-3"},[t._v(t._s(t.project.slug)+": "+t._s(t.project.title))]),t._v(" "),t.isSenior?s("button",{staticClass:"btn btn-outline-primary",on:{click:t.editProjectModal}},[t._v(t._s(t.$t("project.edit.btn")))]):t._e()]),t._v(" "),s("div",{staticClass:"col-lg-4 col-12"},[s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-header"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("project.show.details")))])]),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-4 col-md-5 col-3"},[t._v(t._s(t.$t("project.client.name"))+":")]),t._v(" "),s("div",{staticClass:"col-lg-8 col-md-7 col-9"},[s("router-link",{staticClass:"text-decoration-none",attrs:{to:{name:"clients.show",params:{id:t.project.client.id}}}},[t._v(t._s(t.project.client.name))])],1)]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-4 col-md-5 col-3"},[t._v(t._s(t.$t("project.status"))+":")]),t._v(" "),s("div",{staticClass:"col-lg-8 col-md-7 col-9"},[t._v(t._s(t._f("capitalize")(t.project.status)))])])])]),t._v(" "),s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-header"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("project.show.dates")))])]),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-4 col-md-5 col-3"},[t._v(t._s(t.$t("project.start_date"))+":")]),t._v(" "),s("div",{staticClass:"col-lg-8 col-md-7 col-9"},[t._v(t._s(t._f("date")(new Date(t.project.start_date),"DD.MM.YYYY")))])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-4 col-md-5 col-3"},[t._v(t._s(t.$t("project.end_date"))+":")]),t._v(" "),s("div",{staticClass:"col-lg-8 col-md-7 col-9"},[t._v(t._s(t._f("date")(new Date(t.project.end_date),"DD.MM.YYYY")))])])])]),t._v(" "),s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-header d-flex justify-content-between"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("project.team")))]),t._v(" "),t.isSenior?s("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:t.addUserToProjectModal}},[t._v(t._s(t.$t("project.team.add.btn")))]):t._e()]),t._v(" "),s("div",{staticClass:"card-body"},t._l(t.project.users,(function(e,a){return s("div",{key:e.id,staticClass:"d-flex",class:{"mb-2":a<t.project.users.length-1}},[e.photo?s("div",{staticClass:"pr-2 d-flex"},[s("img",{staticClass:"avatar avatar-sm",attrs:{src:e.photo,alt:e.fullName}})]):t._e(),t._v(" "),s("div",{staticClass:"d-flex align-items-center"},[s("p",{staticClass:"mb-0"},[t._v(t._s(e.fullName))])])])})),0)]),t._v(" "),s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-header"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("project.overview")))])]),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"d-flex justify-content-around"},[s("router-link",{staticClass:"btn btn-outline-primary btn-sm",attrs:{to:{name:"projects.show.roadmap",params:{slug:t.project.slug}}}},[t._v(t._s(t.$t("project.overview.roadmap")))]),t._v(" "),s("router-link",{staticClass:"btn btn-outline-primary btn-sm",attrs:{to:{name:"projects.show.gantt",params:{slug:t.project.slug}}}},[t._v(t._s(t.$t("project.overview.gantt")))])],1)])])]),t._v(" "),s("div",{staticClass:"col-lg-8 col-12"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 mb-4"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("project.show.tasks")))]),t._v(" "),t.isSenior?s("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:t.addTaskModal}},[t._v(t._s(t.$t("project.task.add.btn")))]):t._e()]),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"task-sort"}},[t._v(t._s(t.$t("task.sort")))]),t._v(" "),s("b-form-select",{staticClass:"form-control",attrs:{id:"task-sort",options:t.taskSortOptions},model:{value:t.taskSort,callback:function(e){t.taskSort=e},expression:"taskSort"}})],1)])])]),t._v(" "),t.filteredTasks.length>0?t._l(t.filteredTasks,(function(e){return s("div",{staticClass:"col-lg-6 col-12 mb-4"},[s("router-link",{staticClass:"text-decoration-none",attrs:{to:{name:"tasks.show",params:{id:e.id}}}},[s("div",{staticClass:"card h-100"},[s("div",{staticClass:"card-header"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(e.title))])]),t._v(" "),s("div",{staticClass:"card-body d-flex justify-content-between"},[s("div",{staticClass:"d-flex"},[e.assignee?s("div",{staticClass:"d-flex align-items-center"},[s("img",{staticClass:"avatar avatar-md mr-2",attrs:{src:e.assignee.photo,alt:e.assignee.fullName}})]):t._e(),t._v(" "),s("div",[s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("date")(new Date(e.start_date),"DD.MM.YYYY")))]),t._v(" "),s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("date")(new Date(e.end_date),"DD.MM.YYYY")))])])]),t._v(" "),s("div",[s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("capitalize")(e.status)))]),t._v(" "),s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("capitalize")(e.priority)))])])])])])],1)})):[s("div",{staticClass:"col-12"},[t._v("\n                            "+t._s(t.$t("project.task.no_tasks"))+"\n                        ")])]],2)]),t._v(" "),s("custom-modal",{ref:"editProjectModal",attrs:{modalSchema:t.modalSchemaEditProject},on:{ok:t.editProject}}),t._v(" "),s("custom-modal",{ref:"addTaskModal",attrs:{modalSchema:t.modalSchemaAddTask},on:{ok:t.addTask}}),t._v(" "),s("custom-modal",{ref:"addUserToProjectModal",attrs:{modalSchema:t.modalSchemaAddUserToProject},on:{ok:t.addUserToProject}})]:403===t.errorCode?[s("div",{staticClass:"col-12"},[s("error-forbidden")],1)]:404===t.errorCode?[s("div",{staticClass:"col-12"},[s("error-not-found")],1)]:t._e()],2)])}),[],!1,null,null,null);e.default=c.exports}}]);