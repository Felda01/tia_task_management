(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{36:function(t,e,s){"use strict";s.r(e);var i=s(2);function a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function n(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var o={name:"RoadMap",computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?a(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({sortedVersions:function(){if(this.project&&this.project.versions)return _.orderBy(this.project.versions,"end_date","asc")}},Object(i.b)(["isSenior","userId"])),data:function(){return{project:null,loading:!1,errorCode:0,modalSchemaAddVersion:{form:{url:"/api/versions",method:"post",fields:[{label:this.$t("version.title"),required:!0,name:"title",input:"text",type:"text",value:"",config:{}},{label:this.$t("version.end_date"),required:!0,name:"end_date",input:"date",type:"date",value:"",config:{}}],hiddenFields:[],config:{}},modalRef:"addVersion",modalTitle:this.$t("project.version.add.title.modal"),okBtnTitle:this.$t("modal.add.btn")},modalSchemaEditVersion:{form:{url:"",method:"put",fields:[],hiddenFields:[],config:{}},modalRef:"editVersion",modalTitle:this.$t("project.version.edit.title.modal"),okBtnTitle:this.$t("modal.edit.btn")},removeVersionMessageBoxOptions:{title:this.$t("modalWarning"),okVariant:"success",cancelVariant:"danger"}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;this.loading=!0,this.axios.get("/api/projects/"+this.$route.params.slug+"/roadmap").then((function(e){t.project=e.data.data,t.loading=!1})).catch((function(e){t.errorCode=e.response.status,t.loading=!1}))},sortedArray:function(t,e){return t.sort((function(t,s){return t[e]-s[e]}))},addVersionModal:function(){this.modalSchemaAddVersion.form.hiddenFields=[{name:"project_id",value:this.project.id}],this.$refs.addVersionModal.openModal()},addVersion:function(t){this.project.versions||(this.project.versions=[]),this.project.versions.push(t.data.data)},editVersionModal:function(t){this.modalSchemaEditVersion.form.url="/api/versions/"+t.id,this.modalSchemaEditVersion.form.fields=[{label:this.$t("version.title"),required:!0,name:"title",input:"text",type:"text",value:t.title,config:{}},{label:this.$t("version.end_date"),required:!0,name:"end_date",input:"date",type:"date",value:t.end_date,config:{}}],this.$refs.editVersionModal.openModal()},editVersion:function(t){var e=t.data.data,s=this.project.versions.findIndex((function(t){return t.id===e.uid}));this.project.versions.splice(s,1,e)},deleteVersionModal:function(t){var e=this;this.$bvModal.msgBoxConfirm(this.$t("version.removeMessage"),this.removeVersionMessageBoxOptions).then((function(s){s&&e.axios.delete("/api/versions/"+t.id).then((function(t){e.task.timeTracking=_.filter(e.task.timeTracking,(function(t){return t.id!==time.id}))}))}))},doneTasksInVersion:function(t){for(var e=0,s=0;s<t.tasks.length;s++)"completed"===t.tasks[s].status&&(e+=1);return e/t.tasks.length*100}}},r=s(1),d=Object(r.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"project-road-map"},[s("div",{staticClass:"row"},[t.loading?[s("div",{staticClass:"col-12"},t._l(3,(function(e){return s("content-placeholders",{key:e,staticClass:"mb-4"},[s("content-placeholders-heading"),t._v(" "),s("content-placeholders-text",{attrs:{lines:3}})],1)})),1)]:t.project?[s("div",{staticClass:"col-12 mb-4"},[s("router-link",{staticClass:"btn btn-outline-primary btn-sm",attrs:{to:{name:"projects.show",params:{slug:t.project.slug}}}},[t._v(t._s(t.$t("project.overview.back_to_project")))])],1),t._v(" "),s("div",{staticClass:"col-12 mb-4 d-flex justify-content-between"},[s("h2",[t._v(t._s(t.$t("project.show.versions")))]),t._v(" "),t.isSenior?s("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:t.addVersionModal}},[t._v(t._s(t.$t("project.version.add.btn")))]):t._e()]),t._v(" "),s("div",{staticClass:"col-12"},[t.project.versions&&t.project.versions.length>0?t._l(t.sortedVersions,(function(e,i){return s("div",{key:e.id,staticClass:"card mb-4"},[s("div",{staticClass:"card-header"},[s("div",{staticClass:"d-flex flex-md-row flex-column justify-content-md-between align-items-md-center"},[s("h5",{staticClass:"mb-3 mb-md-0"},[t._v(t._s(e.title)+" ("+t._s(t._f("date")(new Date(e.end_date),"DD.MM.YYYY"))+")")]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between justify-content-md-end"},[t.isSenior?s("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(s){return t.editVersionModal(e)}}},[t._v(t._s(t.$t("project.version.edit.btn")))]):t._e(),t._v(" "),t.isSenior?s("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:function(s){return t.deleteVersionModal(e)}}},[t._v(t._s(t.$t("project.version.delete.btn")))]):t._e()])])]),t._v(" "),s("div",{staticClass:"card-body"},[e.tasks&&e.tasks.length>0?[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 mb-4"},[s("b-progress",{attrs:{value:t.doneTasksInVersion(e),max:100,"show-progress":""}})],1),t._v(" "),t._l(e.tasks,(function(e){return s("div",{staticClass:"col-lg-6 col-12 mb-4"},[s("router-link",{staticClass:"text-decoration-none",attrs:{to:{name:"tasks.show",params:{id:e.id}}}},[s("div",{staticClass:"card h-100"},[s("div",{staticClass:"card-header"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(e.title))])]),t._v(" "),s("div",{staticClass:"card-body d-flex justify-content-between"},[s("div",{staticClass:"d-flex"},[e.assignee?s("div",{staticClass:"d-flex align-items-center"},[s("img",{staticClass:"avatar avatar-md mr-2",attrs:{src:e.assignee.photo,alt:e.assignee.fullName}})]):t._e(),t._v(" "),s("div",[s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("date")(new Date(e.start_date),"DD.MM.YYYY")))]),t._v(" "),s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("date")(new Date(e.end_date),"DD.MM.YYYY")))])])]),t._v(" "),s("div",[s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("capitalize")(e.status)))]),t._v(" "),s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("capitalize")(e.priority)))])])])])])],1)}))],2)]:[t._v("\n                                "+t._s(t.$t("version.task.no_tasks"))+"\n                            ")]],2)])})):[t._v("\n                    "+t._s(t.$t("project.version.no_versions"))+"\n                ")],t._v(" "),t.project.tasks_no_version&&t.project.tasks_no_version.length>0?[s("div",{staticClass:"card"},[t._m(0),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},t._l(t.project.tasks_no_version,(function(e,i){return s("div",{key:"task"+e.id,staticClass:"col-lg-6 col-12 mb-4"},[s("router-link",{staticClass:"text-decoration-none",attrs:{to:{name:"tasks.show",params:{id:e.id}}}},[s("div",{staticClass:"card h-100"},[s("div",{staticClass:"card-header"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(e.title))])]),t._v(" "),s("div",{staticClass:"card-body d-flex justify-content-between"},[s("div",{staticClass:"d-flex"},[e.assignee?s("div",{staticClass:"d-flex align-items-center"},[s("img",{staticClass:"avatar avatar-md mr-2",attrs:{src:e.assignee.photo,alt:e.assignee.fullName}})]):t._e(),t._v(" "),s("div",[s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("date")(new Date(e.start_date),"DD.MM.YYYY")))]),t._v(" "),s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("date")(new Date(e.end_date),"DD.MM.YYYY")))])])]),t._v(" "),s("div",[s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("capitalize")(e.status)))]),t._v(" "),s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("capitalize")(e.priority)))])])])])])],1)})),0)])])]:t._e()],2),t._v(" "),s("custom-modal",{ref:"addVersionModal",attrs:{modalSchema:t.modalSchemaAddVersion},on:{ok:t.addVersion}}),t._v(" "),s("custom-modal",{ref:"editVersionModal",attrs:{modalSchema:t.modalSchemaEditVersion},on:{ok:t.editVersion}})]:403===t.errorCode?[s("div",{staticClass:"col-12"},[s("error-forbidden")],1)]:404===t.errorCode?[s("div",{staticClass:"col-12"},[s("error-not-found")],1)]:t._e()],2)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("h5",{staticClass:"mb-0"},[this._v("No version")])])])])}],!1,null,null,null);e.default=d.exports}}]);