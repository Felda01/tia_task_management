(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{30:function(t,e,s){"use strict";s.r(e);var i=function(t){return void 0===t},n=function(t){return Array.isArray(t)},a=function(t){return t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.slice},o=function(t,e,s,r){return(e=e||{}).indices=!i(e.indices)&&e.indices,e.nullsAsUndefineds=!i(e.nullsAsUndefineds)&&e.nullsAsUndefineds,e.booleansAsIntegers=!i(e.booleansAsIntegers)&&e.booleansAsIntegers,s=s||new FormData,i(t)||(null===t?e.nullsAsUndefineds||s.append(r,""):"boolean"!=typeof t?n(t)?t.length&&t.forEach((function(t,i){o(t,e,s,r+"["+(e.indices?i:"")+"]")})):t instanceof Date?s.append(r,t.toISOString()):t!==Object(t)||function(t){return a(t)&&"string"==typeof t.name&&("object"==typeof t.lastModifiedDate||"number"==typeof t.lastModified)}(t)||a(t)?s.append(r,t):Object.keys(t).forEach((function(i){var a=t[i];if(n(a))for(;i.length>2&&i.lastIndexOf("[]")===i.length-2;)i=i.substring(0,i.length-2);o(a,e,s,r?r+"["+i+"]":i)})):s.append(r,e.booleansAsIntegers?t?1:0:t)),s},r=s(2);function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var d={name:"UserDetail",computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){c(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({owner:function(){return this.user&&this.user.id===this.userId}},Object(r.b)(["userId","isSenior"])),data:function(){return{loading:!1,user:null,errorCode:0,modalSchemaEditUser:{form:{url:"/api/users/"+this.$route.params.id,method:"post",fields:[],hiddenFields:[],config:{transformRequest:[function(t,e){return o(t)}],headers:{"Content-Type":"multipart/form-data"}}},modalRef:"editUser",modalTitle:this.$t("user.edit.title"),okBtnTitle:this.$t("modal.edit.btn")},modalSchemaEditUserType:{form:{url:"/api/users/"+this.$route.params.id+"/position",method:"put",fields:[],hiddenFields:[],config:{}},modalRef:"editUserType",modalTitle:this.$t("user.type.edit.title"),okBtnTitle:this.$t("modal.edit.btn")},removeUserMessageBoxOptions:{title:this.$t("modalWarning"),okVariant:"success",cancelVariant:"danger"},removeNotificationMessageBoxOptions:{title:this.$t("modalWarning"),okVariant:"success",cancelVariant:"danger"},removeAllNotificationMessageBoxOptions:{title:this.$t("modalWarning"),okVariant:"success",cancelVariant:"danger"}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;this.loading=!0,this.axios.get("/api/users/"+this.$route.params.id).then((function(e){t.user=e.data.data,t.usersTypeOptions=e.data.meta.usersTypeOptions,t.loading=!1})).catch((function(e){t.errorCode=e.response.status,t.loading=!1}))},editUserModal:function(){this.modalSchemaEditUser.form.fields=[{label:this.$t("user.email"),required:!0,name:"email",input:"text",type:"email",value:this.user.email,config:{}},{label:this.$t("user.first_name"),required:!0,name:"first_name",input:"text",type:"text",value:this.user.first_name,config:{}},{label:this.$t("user.last_name"),required:!0,name:"last_name",input:"text",type:"text",value:this.user.last_name,config:{}},{label:this.$t("user.new.photo"),required:!1,name:"photo",input:"file",type:"file",value:null,config:{photo:this.user.photo}}],this.modalSchemaEditUser.form.hiddenFields=[{name:"_method",value:"PUT"}],this.$refs.editUserModal.openModal()},editUser:function(t){this.user=t.data.data,this.$store.dispatch("getUser")},editUserTypeModal:function(){var t,e=this;t=_.filter(this.usersTypeOptions,(function(t){return t.value!==e.user.type})),this.modalSchemaEditUserType.form.fields=[{label:this.$t("user.type"),required:!0,name:"type",input:"select",type:"select",value:"senior",config:{options:t}}],this.$refs.editUserTypeModal.openModal()},editUserType:function(t){this.user=t.data.data,this.$store.dispatch("getUser")},removeUser:function(){var t=this;this.$bvModal.msgBoxConfirm(this.$t("user.removeMessage"),this.removeUserMessageBoxOptions).then((function(e){e&&t.axios.delete("/api/users/"+t.user.id).then((function(e){t.$router.replace({name:"users"})}))}))},removeNotification:function(t){var e=this;this.$bvModal.msgBoxConfirm(this.$t("notification.removeMessage"),this.removeNotificationMessageBoxOptions).then((function(s){s&&e.axios.delete("/api/notifications/"+t.id).then((function(s){e.user.notifications=_.filter(e.user.notifications,(function(e){return e.id!==t.id}))})).catch((function(t){e.$bvModal.msgBoxOk(t.response.data.message,{okVariant:"danger"})}))}))},removeAllNotifications:function(){var t=this;this.userId&&this.$bvModal.msgBoxConfirm(this.$t("notification.removeAllMessage"),this.removeAllNotificationMessageBoxOptions).then((function(e){e&&t.axios.delete("/api/users/"+t.userId+"/notifications").then((function(e){t.user.notifications=[]})).catch((function(e){console.log(e.response),t.$bvModal.msgBoxOk(e.response.data.status,{okVariant:"danger"})}))}))}}},u=s(1),f=Object(u.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-detail"},[s("div",{staticClass:"row"},[t.loading?[s("div",{staticClass:"col-12"},[s("content-placeholders",{staticClass:"mb-4"},[s("content-placeholders-heading",{attrs:{img:!0}})],1)],1),t._v(" "),s("div",{staticClass:"col-md-4 col-12"},[s("content-placeholders",{staticClass:"mb-4"},[s("content-placeholders-heading"),t._v(" "),s("content-placeholders-text",{attrs:{lines:3}})],1),t._v(" "),s("content-placeholders",{staticClass:"mb-4"},[s("content-placeholders-heading"),t._v(" "),s("content-placeholders-text",{attrs:{lines:2}})],1)],1),t._v(" "),s("div",{staticClass:"col-md-8 col-12"},[s("content-placeholders",{staticClass:"mb-4"},[s("content-placeholders-heading"),t._v(" "),s("content-placeholders-text",{attrs:{lines:8}})],1)],1)]:t.user?[s("div",{staticClass:"col-12 mb-4 d-flex flex-lg-row flex-column justify-content-lg-between align-items-lg-center"},[s("h1",{staticClass:"d-flex align-items-center mb-lg-0 mb-3"},[s("img",{staticClass:"avatar avatar-md mr-2",attrs:{src:t.user.photo,alt:t.user.fullName}}),t._v(t._s(t.user.fullName))]),t._v(" "),t.owner?s("button",{staticClass:"btn btn-outline-primary",on:{click:t.editUserModal}},[t._v(t._s(t.$t("user.edit.btn")))]):t._e(),t._v(" "),!t.owner&&t.isSenior?s("button",{staticClass:"btn btn-outline-danger",on:{click:t.removeUser}},[t._v(t._s(t.$t("user.remove.btn")))]):t._e()]),t._v(" "),s("div",{staticClass:"col-lg-4 col-12"},[s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("user.show.detail")))])]),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-4 col-md-5"},[t._v(t._s(t.$t("user.full_name"))+":")]),t._v(" "),s("div",{staticClass:"col-lg-8 col-md-7"},[t._v(t._s(t.user.fullName))])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-4 col-md-5"},[t._v(t._s(t.$t("user.email"))+":")]),t._v(" "),s("div",{staticClass:"col-lg-8 col-md-7"},[t._v(t._s(t.user.email))])])])]),t._v(" "),s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("user.show.position")))]),t._v(" "),"junior"===t.user.type&&t.isSenior?s("button",{staticClass:"btn btn-outline-primary",on:{click:t.editUserTypeModal}},[t._v(t._s(t.$t("user.type.edit.btn")))]):t._e()]),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"d-flex justify-content-between"},[s("p",{staticClass:"mb-0"},[t._v(t._s(t._f("capitalize")(t.user.type)))])])])])]),t._v(" "),s("div",{staticClass:"col-lg-8 col-12"},[t.owner?s("div",{staticClass:"card mb-4"},[s("div",{staticClass:"card-header d-flex justify-content-between align-items-center"},[s("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("user.show.notifications")))]),t._v(" "),t.user.notifications&&t.user.notifications.length>0?s("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:t.removeAllNotifications}},[t._v(t._s(t.$t("user.notifications.removeAll")))]):t._e()]),t._v(" "),s("div",{staticClass:"card-body"},[t.user.notifications&&t.user.notifications.length>0?t._l(t.user.notifications,(function(e,i){return s("div",{staticClass:"p-3",class:{"border-bottom":i<t.user.notifications.length-1}},[s("div",{staticClass:"d-flex justify-content-between align-items-center mb-2"},[s("p",{staticClass:"mb-0"},[s("router-link",{staticClass:"text-decoration-none",attrs:{to:{name:"tasks.show",params:{id:e.task.id}}}},[t._v(t._s(e.task.project.slug)+": "+t._s(e.task.title))]),t._v(" - "+t._s(t._f("date")(new Date(e.created_at),"DD.MM.YYYY HH:mm")))],1),t._v(" "),s("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:function(s){return t.removeNotification(e)}}},[t._v("X")])]),t._v(" "),s("p",{staticClass:"mb-0"},[t._v(t._s(e.message))])])})):[t._v("\n                            "+t._s(t.$t("user.notifications.no_notifications"))+"\n                        ")]],2)]):t._e()]),t._v(" "),s("custom-modal",{ref:"editUserTypeModal",attrs:{modalSchema:t.modalSchemaEditUserType},on:{ok:t.editUserType}}),t._v(" "),s("custom-modal",{ref:"editUserModal",attrs:{modalSchema:t.modalSchemaEditUser},on:{ok:t.editUser}})]:403===t.errorCode?[s("div",{staticClass:"col-12"},[s("error-forbidden")],1)]:404===t.errorCode?[s("div",{staticClass:"col-12"},[s("error-not-found")],1)]:t._e()],2)])}),[],!1,null,null,null);e.default=f.exports}}]);